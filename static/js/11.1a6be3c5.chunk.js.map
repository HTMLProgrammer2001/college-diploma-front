{"version":3,"sources":["common/formElements/InputElement.tsx","common/BackButton.tsx","common/ErrorElement.tsx","common/SortItem.tsx","common/Paginator/index.tsx","utils/validators/required.ts","common/UserCan.tsx","common/formElements/DateElement.tsx","utils/helpers/objToParams.ts","utils/hooks/useHttp.ts","utils/helpers/debounce.ts","common/formElements/DataListElement.tsx","common/formElements/FileElement.tsx","common/formElements/styles.module.scss","pages/Publications/all/PublicationsFilterForm.tsx","pages/Publications/all/PublicationItem.tsx","redux/publications/all/selectors.ts","redux/publications/delete/selectors.ts","redux/publications/all/actions.ts","utils/api/models/publicationsApi.ts","redux/publications/all/thunks.ts","redux/publications/delete/actions.ts","redux/publications/delete/thunks.ts","pages/Publications/all/PublicationsTable.tsx","pages/Publications/all/index.tsx","redux/publications/edit/selectors.ts","redux/publications/edit/thunks/thunkEditPublicationLoad.ts","redux/publications/edit/actions.ts","redux/publications/edit/thunks/thunkEditPublication.ts","pages/Publications/edit/EditPublicationForm.tsx","pages/Publications/edit/index.tsx","pages/Publications/add/AddPublicationForm.tsx","redux/publications/add/thunks.ts","pages/Publications/add/index.tsx","redux/publications/single/selectors.ts","pages/Publications/single/PublicationInfo.tsx","redux/publications/single/thunks.ts","redux/publications/single/actions.ts","pages/Publications/single/index.tsx","pages/Publications/import/ImportPublicationsForm.tsx","redux/publications/import/thunks.ts","pages/Publications/import/index.tsx","pages/Publications/index.tsx"],"names":["InputElement","onlyInValid","props","controlId","name","label","column","type","value","input","className","onChange","onFocus","onBlur","isValid","meta","touched","valid","undefined","isInvalid","error","Feedback","style","display","BackButton","history","useHistory","variant","onClick","goBack","ErrorElement","SortItem","state","change","param","cn","Paginator","totalItems","curPage","setCur","pageSize","size","hasPrev","totalPages","Math","ceil","hasNext","floor","curPaginator","Item","Array","fill","map","val","index","curItemNumber","key","active","required","str","connected","connect","user","selectMeInfo","role","children","DateElement","selected","dateFormat","showMonthDropdown","showYearDropdown","d","data","sortRules","isArray","forEach","item","Object","objKey","useHttp","useState","isLoading","setLoading","setError","setData","handler","useCallback","a","url","headers","method","Promise","res","setTimeout","axios","request","params","Authorization","localStorage","getItem","resp","response","message","debounce","fn","delay","timer","args","clearTimeout","DataListElement","id","placeholder","multiple","isFilter","query","setQuery","setSelected","reqData","useEffect","length","makeRequest","filter","includes","page","q","onInputChange","FormGroup","FormLabel","onSearch","console","log","filterBy","labelKey","maxResults","minLength","options","title","concat","emptyLabel","searchText","selectedOptions","opt","renderMenuItemChildren","option","FormControl","FileElement","onDrop","acceptedFiles","getRootProps","getInputProps","position","styles","fileDrop","fileDrop__svg","xmlns","x","y","width","height","fileDrop__rect","fileDrop__rect_2","fileDrop__label","module","exports","reduxForm","form","handleSubmit","onSubmit","Translation","t","Row","Field","component","process","Button","PublicationItem","publication","isDeleting","del","authors","date_of_publication","UserCan","Roles","MODERATOR","to","Spinner","animation","selectAllPublicationsState","publications","all","selectAllPublicationsSort","sort","selectAllPublicationsPagination","currentPage","total","selectDeletePublications","allPublicationsStart","ALL_PUBLICATIONS_START","allPublicationsError","ALL_PUBLICATIONS_ERROR","allPublicationsSuccess","ranksResponse","ALL_PUBLICATIONS_SUCCESS","payload","allPublicationsDelete","ALL_PUBLICATIONS_DELETE","client","create","baseURL","publicationsApi","getPublications","filters","objToParams","get","getPublication","editPublication","vals","put","deletePublication","delete","addPublication","post","importPublications","formData","FormData","append","thunkAllPublications","dispatch","getState","getFormValues","pagination","deletePublicationStart","DELETE_PUBLICATION_START","deletePublicationError","DELETE_PUBLICATION_ERROR","deletePublicationSuccess","DELETE_PUBLICATION_SUCCESS","thunkDeletePublication","toast","success","deleting","changeSort","field","ALL_PUBLICATIONS_CHANGE_SORT","allPublicationsChangeSort","load","deleteItem","useTranslation","Table","striped","bordered","hover","minWidth","findSortRule","direction","colSpan","Loader","what","findIndex","paginator","changePage","document","Card","Body","Footer","selectEditPublicationState","edit","selectEditPublication","thunkEditPublicationLoad","EDIT_PUBLICATION_LOAD_START","EDIT_PUBLICATION_LOAD_SUCCESS","EDIT_PUBLICATION_LOAD_ERROR","thunkEditPublication","startSubmit","stopSubmit","_error","errors","initialize","validate","rows","editState","submitting","isSubmitting","loadPublication","send","submit","IsUserRoleMore","match","EditPublicationForm","disabled","thunkAddPublication","reset","add","AddPublicationForm","selectPublicationSingleState","single","PublicationInfo","Trans","i18nKey","publisher","href","description","thunkSinglePublication","PUBLICATION_SINGLE_START","PUBLICATION_SINGLE_SUCCESS","PUBLICATION_SINGLE_ERROR","thunkImportPublication","isSubmit","ImportPublicationsForm","target","VIEWER","path","exact","AllPublicationsPage","AddPublicationPage","ImportPublicationPage","EditPublicationPage","SinglePublicationPage","NotFoundPage"],"mappings":"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","file":"static/js/11.1a6be3c5.chunk.js","sourcesContent":["import React, {useEffect} from 'react';\r\nimport {WrappedFieldProps} from 'redux-form';\r\nimport {FormControl, FormGroup, FormLabel} from 'react-bootstrap';\r\n\r\n\r\ntype IInputElementProps = WrappedFieldProps & HTMLInputElement & {label: string, onlyInValid: boolean};\r\nconst InputElement: React.FC<IInputElementProps> = ({onlyInValid = true, ...props}) => {\r\n\t// useEffect(() => {\r\n\t// \tif(!props.meta.touched && props.defaultValue)\r\n\t// \t\tprops.input.onChange(props.defaultValue as any, props.name);\r\n\t// }, []);\r\n\r\n\treturn (\r\n\t\t<FormGroup controlId={props.name}>\r\n\t\t\t{\r\n\t\t\t\tprops.label &&\r\n\t\t\t\t<FormLabel column={true}>{props.label}</FormLabel>\r\n\t\t\t}\r\n\r\n\t\t<FormControl\r\n\t\t\ttype={props.type}\r\n\t\t\tname={props.name}\r\n\t\t\tvalue={props.input.value}\r\n\t\t\tclassName={props.className}\r\n\t\t\tonChange={props.input.onChange}\r\n\t\t\tonFocus={props.input.onFocus}\r\n\t\t\tonBlur={props.input.onBlur}\r\n\t\t\tisValid={!onlyInValid && props.meta.touched ? props.meta.valid : undefined}\r\n\t\t\tisInvalid={props.meta.touched ? !props.meta.valid : undefined}\r\n\t\t/>\r\n\r\n\t\t\t{\r\n\t\t\t\tprops.meta.error &&\r\n\t\t\t\t<FormControl.Feedback type=\"invalid\" style={{display: 'block'}}>\r\n\t\t\t\t\t{props.meta.touched && props.meta.error}\r\n\t\t\t\t</FormControl.Feedback>\r\n\t\t\t}\r\n\t\t</FormGroup>\r\n\t);\r\n};\r\n\r\nexport default InputElement;\r\n","import React from 'react';\r\nimport {Button} from 'react-bootstrap';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\n\r\nconst BackButton: React.FC<{}> = () => {\r\n\tconst history = useHistory();\r\n\r\n\treturn (\r\n\t\t<Button variant=\"light\" onClick={() => history.goBack()}>Назад</Button>\r\n\t);\r\n};\r\n\r\nexport default BackButton;\r\n","import React from 'react';\r\n\r\n\r\ntype IErrorProps = {\r\n\terror?: string\r\n};\r\n\r\nconst ErrorElement: React.FC<IErrorProps> = ({error}) => (\r\n\t<div>{error || 'Произошла ошибка'}</div>\r\n);\r\n\r\nexport default ErrorElement;\r\n","import React from 'react';\r\nimport cn from 'classnames';\r\n\r\n\r\ntype ISortItemProps = {\r\n\tstate: -1 | 1 | undefined,\r\n\tchange: (param: string) => void,\r\n\tparam: string\r\n};\r\n\r\nconst SortItem: React.FC<ISortItemProps> = ({state, change, param}) => (\r\n\t<i className={cn(\"fa cur pull-right\", {\r\n\t\t[\"fa-sort-amount-asc\"]: state == 1 || state == undefined,\r\n\t\t[\"fa-sort-amount-desc\"]: state == -1,\r\n\t\t[\"opacity-5\"]: state == undefined,\r\n\t})}\r\n\t   onClick={() => change(param)}\r\n\t/>\r\n);\r\n\r\nexport default SortItem;\r\n","import React from 'react';\r\nimport {Pagination} from 'react-bootstrap';\r\n\r\n\r\ntype IPaginatorProps = {\r\n\ttotalItems: number,\r\n\tcurPage: number,\r\n\tsize?: number,\r\n\tpageSize: number,\r\n\tsetCur: (page: number) => void\r\n};\r\n\r\nconst Paginator: React.FC<IPaginatorProps> = ({totalItems, curPage, setCur, pageSize, size = 5}) => {\r\n\tlet hasPrev = curPage > size,\r\n\t\ttotalPages = Math.ceil(totalItems/pageSize),\r\n\t\thasNext = totalPages > (Math.floor((curPage - 1) / size) + 1) * size,\r\n\t\tcurPaginator = Math.floor((curPage - 1) / size);\r\n\r\n\tif (totalPages <= 1)\r\n\t\treturn null;\r\n\r\n\treturn (\r\n\t\t<Pagination>\r\n\t\t\t{\r\n\t\t\t\thasPrev &&\r\n\t\t\t\t\t<Pagination.Item onClick={() => setCur((curPaginator - 1) * size + 1)}>\r\n\t\t\t\t\t\t&lt;\r\n\t\t\t\t\t</Pagination.Item>\r\n\t\t\t}\r\n\r\n\t\t\t{\r\n\t\t\t\tnew Array(size).fill('').map((val, index) => {\r\n\t\t\t\t\tconst curItemNumber = curPaginator * size + index + 1;\r\n\r\n\t\t\t\t\tif(curItemNumber > totalPages)\r\n\t\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Pagination.Item\r\n\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\tactive={curPage == curItemNumber}\r\n\t\t\t\t\t\t\tonClick={() => setCur(curItemNumber)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{curItemNumber}\r\n\t\t\t\t\t\t</Pagination.Item>\r\n\t\t\t\t\t);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\t{\r\n\t\t\t\thasNext &&\r\n\t\t\t\t\t<Pagination.Item onClick={() => setCur((curPaginator + 1) * size + 1)}>\r\n\t\t\t\t\t\t&gt;\r\n\t\t\t\t\t</Pagination.Item>}\r\n\t\t</Pagination>\r\n\t);\r\n};\r\n\r\nexport default Paginator;\r\n","const required = (str: string) => {\r\n\treturn str ? null : 'Поле обязательно для заполнения'\r\n};\r\n\r\nexport default required;\r\n","import React from 'react';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\n\r\nimport {RootState} from '../redux';\r\nimport {selectMeInfo} from '../redux/me/selectors';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\tuser: selectMeInfo(state)\r\n});\r\n\r\nconst connected = connect(mapStateToProps);\r\n\r\ntype IUserCanProps = {role: number, children: any} & ConnectedProps<typeof connected>;\r\nconst UserCan: React.FC<IUserCanProps> = ({role, children, user}) => {\r\n\treturn user.role <= role ? <>{children}</> : null;\r\n};\r\n\r\nexport default connected(UserCan);\r\n","import React from 'react';\r\nimport {WrappedFieldProps} from 'redux-form';\r\nimport DatePicker, {ReactDatePickerProps} from 'react-datepicker';\r\nimport {FormGroup, FormLabel, FormControl} from 'react-bootstrap';\r\nimport {instanceOf} from 'prop-types';\r\n\r\n\r\ntype IDateElementProps = WrappedFieldProps &\r\n\tHTMLInputElement & {label: string} & ReactDatePickerProps;\r\n\r\nconst DateElement: React.FC<IDateElementProps> = ({meta, input, name, label, className}) => (\r\n\t<FormGroup>\r\n\t\t{\r\n\t\t\tlabel &&\r\n\t\t\t\t<FormLabel column={true}>{label}</FormLabel>\r\n\t\t}\r\n\r\n\t\t<DatePicker\r\n\t\t\tselected={input.value}\r\n\t\t\tclassName={className}\r\n\t\t\tdateFormat=\"dd.MM.yyyy\"\r\n\t\t\tshowMonthDropdown={true}\r\n\t\t\tshowYearDropdown={true}\r\n\t\t\tonChange={(d: any) => input.onChange(d, name)}\r\n\t\t/>\r\n\r\n\t\t{\r\n\t\t\tmeta.touched && meta.error &&\r\n\t\t\t\t<FormControl.Feedback style={{display: 'block'}}>\r\n\t\t\t\t\t{meta.error}\r\n\t\t\t\t</FormControl.Feedback>\r\n\t\t}\r\n\t</FormGroup>\r\n);\r\n\r\nexport default DateElement;\r\n","export default (data: Object | Array<any>, name: string): Object => {\r\n\tlet sortRules: any = {};\r\n\r\n\tif(Array.isArray(data)){\r\n\t\tdata.forEach((item, index) => {\r\n\t\t\tlet key = `${name}[${index}]`;\r\n\t\t\tsortRules[key] = item;\r\n\t\t});\r\n\r\n\t\treturn sortRules;\r\n\t}\r\n\r\n\telse if(data instanceof Object){\r\n\t\tfor(let objKey in data){\r\n\t\t\tlet key = `${name}[${objKey}]`;\r\n\t\t\tsortRules[key] = (data as any)[objKey];\r\n\t\t}\r\n\r\n\t\treturn sortRules;\r\n\t}\r\n};\r\n","import axios, {Method} from 'axios';\r\nimport {useCallback, useState} from 'react';\r\n\r\n\r\ntype IHttpHandlerOptions = {\r\n\turl: string,\r\n\tmethod?: Method,\r\n\theaders?: Object,\r\n\tdata?: Object\r\n}\r\n\r\nconst useHttp = <T>() => {\r\n\tconst [isLoading, setLoading] = useState(false);\r\n\tconst [error, setError] = useState<string>(null);\r\n\tconst [data, setData] = useState<T>(null);\r\n\r\n\tconst handler = useCallback(async ({url, headers, method, data}: IHttpHandlerOptions) => {\r\n\t\tsetLoading(true);\r\n\r\n\t\ttry {\r\n\t\t\tawait new Promise(res => {\r\n\t\t\t\tsetTimeout(res, 3000);\r\n\t\t\t});\r\n\r\n\t\t\tconst resp = await axios.request<T>({\r\n\t\t\t\tmethod, url, params: data, headers: {\r\n\t\t\t\t\t...headers,\r\n\t\t\t\t\tAuthorization: `Bearer ${localStorage.getItem('token')}`,\r\n\t\t\t\t\t'Access-Control-Allow-Origin': '*'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsetData(resp.data);\r\n\t\t} catch (e) {\r\n\t\t\tsetError(e.response?.data.message || e.message);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [isLoading, error, data]);\r\n\r\n\treturn {isLoading, error, data, request: handler};\r\n};\r\n\r\nexport default useHttp;\r\n","const debounce = (fn: Function, delay: number): any => {\r\n\tlet timer: any = null;\r\n\r\n\treturn (...args: any[]) => {\r\n\t\tif(timer)\r\n\t\t\tclearTimeout(timer);\r\n\r\n\t\ttimer = setTimeout(() => {\r\n\t\t\tfn(...args);\r\n\t\t}, delay);\r\n\t};\r\n};\r\n\r\nexport default debounce;\r\n","import React, {useEffect, useState} from 'react';\r\nimport {AsyncTypeahead} from 'react-bootstrap-typeahead';\r\nimport {WrappedFieldProps} from 'redux-form';\r\nimport {FormControl, FormGroup, FormLabel} from 'react-bootstrap';\r\n\r\nimport useHttp from '../../utils/hooks/useHttp';\r\nimport {IGeneralPaginationResponse} from '../../interfaces/responses/IGeneralPaginationResponse';\r\nimport debounce from '../../utils/helpers/debounce';\r\n\r\n\r\ntype IDataListOwnProps = {\r\n\turl: string,\r\n\tid: string,\r\n\tplaceholder?: string,\r\n\tsize?: number,\r\n\tmultiple?: boolean,\r\n\tisFilter?: boolean\r\n};\r\n\r\ntype IOption = {\r\n\tid: number,\r\n\ttitle: string\r\n};\r\n\r\ntype IDataListElementProps = WrappedFieldProps & IDataListOwnProps;\r\nconst DataListElement: React.FC<IDataListElementProps> = (props) => {\r\n\tconst {id, placeholder, url, size = 5, multiple, isFilter, input: {onChange, name, value}} = props;\r\n\r\n\t//hooks\r\n\tconst [query, setQuery] = useState(null);\r\n\tconst [selected, setSelected] = useState<IOption[]>([]);\r\n\tconst {request, error, isLoading, data: reqData} = useHttp<IGeneralPaginationResponse<IOption>>();\r\n\r\n\t//hook query changes\r\n\tuseEffect(() => {\r\n\t\tif (query != null && query.length >= 1)\r\n\t\t\tmakeRequest();\r\n\t}, [query]);\r\n\r\n\t//hook for selected\r\n\tuseEffect(() => {\r\n\t\tif(!multiple)\r\n\t\t\tsetSelected(value ? selected.filter(({id}) => id == value) : []);\r\n\t\telse\r\n\t\t\tsetSelected(value ? selected.filter(({id}) => value.includes(id)) : []);\r\n\t}, [value]);\r\n\r\n\t//wrapper for making http request\r\n\tconst makeRequest = async (page = 1) => {\r\n\t\tconst data = {q: query, page, pageSize: size};\r\n\t\tawait request({url, data});\r\n\t};\r\n\r\n\t//input change handler\r\n\tconst onInputChange = debounce(async (query: string) => {\r\n\t\t//change cur query\r\n\t\tsetQuery(query);\r\n\t}, 500);\r\n\r\n\tconst onSelect = (selectedOptions: IOption[]) => {\r\n\t\tsetSelected(selectedOptions);\r\n\r\n\t\tif(!multiple)\r\n\t\t\tonChange(selectedOptions[0].id as any, name);\r\n\t\telse\r\n\t\t\tonChange(selectedOptions.map((opt) => opt.id) as any, name);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<FormGroup controlId={id}>\r\n\t\t\t{\r\n\t\t\t\tplaceholder &&\r\n\t\t\t\t\t<FormLabel column={true}>{placeholder}</FormLabel>\r\n\t\t\t}\r\n\r\n\t\t\t<AsyncTypeahead\r\n\t\t\t\tonInputChange={onInputChange}\r\n\t\t\t\tonSearch={() => {console.log('Search')}}\r\n\t\t\t\tfilterBy={['title']}\r\n\t\t\t\tlabelKey=\"title\"\r\n\r\n\t\t\t\tid={name}\r\n\t\t\t\tmaxResults={size}\r\n\t\t\t\tminLength={1}\r\n\t\t\t\toptions={(isFilter ? [{id: -1, title: 'All'}] : []).concat(reqData?.data ? reqData.data : [])}\r\n\t\t\t\tisLoading={isLoading}\r\n\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\temptyLabel=\"No items\"\r\n\t\t\t\tsearchText=\"Search...\"\r\n\t\t\t\tisInvalid={!!error}\r\n\t\t\t\tonChange={onSelect}\r\n\t\t\t\tselected={selected}\r\n\t\t\t\tmultiple={multiple}\r\n\r\n\t\t\t\trenderMenuItemChildren={(option: IOption) => (\r\n\t\t\t\t\t<div key={option.id}>\r\n\t\t\t\t\t\t{option.title}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t/>\r\n\r\n\t\t\t{\r\n\t\t\t\terror &&\r\n\t\t\t\t<FormControl.Feedback type=\"invalid\" style={{display: 'block'}}>\r\n\t\t\t\t\t{props.meta.touched && error}\r\n\t\t\t\t</FormControl.Feedback>\r\n\t\t\t}\r\n\t\t</FormGroup>\r\n\t);\r\n};\r\n\r\nexport default DataListElement;\r\n","import React, {useState} from 'react';\r\nimport Dropzone from 'react-dropzone';\r\nimport {WrappedFieldProps} from 'redux-form';\r\n\r\nimport styles from './styles.module.scss';\r\nimport {FormControl} from 'react-bootstrap';\r\n\r\n\r\ntype IFileElementProps = WrappedFieldProps & {label: string, name: string};\r\nconst FileElement: React.FC<IFileElementProps> = ({name, label, input, meta}) => {\r\n\t\tconst handler = (acceptedFiles: File[]) => {\r\n\t\t\tinput.onChange(acceptedFiles[0] as any, name);\r\n\t\t};\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<Dropzone onDrop={handler}>\r\n\t\t\t\t{\r\n\t\t\t\t\t({getRootProps, getInputProps}) => (\r\n\t\t\t\t\t\t<section style={{position: 'relative'}}>\r\n\t\t\t\t\t\t\t<div {...getRootProps()} className={styles.fileDrop}>\r\n\t\t\t\t\t\t\t\t<input {...getInputProps()}/>\r\n\r\n\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\tclassName={styles.fileDrop__svg}\r\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<rect\r\n\t\t\t\t\t\t\t\t\t\tx=\"0\"\r\n\t\t\t\t\t\t\t\t\t\ty=\"0\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\theight=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\tclassName={styles.fileDrop__rect}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t\t<rect\r\n\t\t\t\t\t\t\t\t\t\tx=\"0\"\r\n\t\t\t\t\t\t\t\t\t\ty=\"0\"\r\n\t\t\t\t\t\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\theight=\"100%\"\r\n\t\t\t\t\t\t\t\t\t\tclassName={`${styles.fileDrop__rect} ${styles.fileDrop__rect_2}`}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</svg>\r\n\r\n\t\t\t\t\t\t\t\t<p className={styles.fileDrop__label}>\r\n\t\t\t\t\t\t\t\t\t<div>{label}</div>\r\n\t\t\t\t\t\t\t\t\t<div>{input.value?.name}</div>\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t)\r\n\t\t\t\t}\r\n\t\t\t</Dropzone>\r\n\r\n\t\t\t{\r\n\t\t\t\tmeta.touched && meta.error &&\r\n\t\t\t\t<FormControl.Feedback style={{display: 'block'}}>\r\n\t\t\t\t\t{meta.error}\r\n\t\t\t\t</FormControl.Feedback>\r\n\t\t\t}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FileElement;\r\n\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fileDrop\":\"styles_fileDrop__3vLx4\",\"fileDrop__label\":\"styles_fileDrop__label__328fS\",\"fileDrop__svg\":\"styles_fileDrop__svg__1fjtk\",\"fileDrop__rect\":\"styles_fileDrop__rect__3KjTF\",\"fileDrop__rect_2\":\"styles_fileDrop__rect_2__3UJkx\"};","import React from 'react';\r\nimport {reduxForm, InjectedFormProps, Field} from 'redux-form';\r\nimport {Translation} from 'react-i18next';\r\nimport {Button, Row} from 'react-bootstrap';\r\n\r\nimport InputElement from '../../../common/formElements/InputElement';\r\nimport DataListElement from '../../../common/formElements/DataListElement';\r\nimport DateElement from '../../../common/formElements/DateElement';\r\n\r\n\r\nexport type IPublicationsFilterData = {\r\n\tfilterTitle: string,\r\n\tfilterUser: number,\r\n\tfilterFrom: string,\r\n\tfilterTo: string\r\n};\r\n\r\ntype IPublicationsFilterFormProps = InjectedFormProps<IPublicationsFilterData>;\r\nconst PublicationsFilterForm: React.FC<IPublicationsFilterFormProps> = ({handleSubmit}) => (\r\n\t<form onSubmit={handleSubmit} className=\"w-100 center flex-column my-3\">\r\n\t\t<Translation>\r\n\t\t\t{t => (\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\tcomponent={DataListElement}\r\n\t\t\t\t\t\tname=\"filterUser\"\r\n\t\t\t\t\t\tid=\"filterUser\"\r\n\t\t\t\t\t\tclassName=\"w-100\"\r\n\t\t\t\t\t\tplaceholder={t('publications.all.filterUser')}\r\n\t\t\t\t\t\turl={`${process.env.REACT_APP_SERVER_URL}/search/users`}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tname=\"filterTitle\"\r\n\t\t\t\t\t\tclassName=\"w-100 ml-1\"\r\n\t\t\t\t\t\tlabel={t('publications.all.filterName')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Row>\r\n\t\t\t)}\r\n\t\t</Translation>\r\n\r\n\t\t<Translation>\r\n\t\t\t{t => (\r\n\t\t\t\t<Row>\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\tcomponent={DateElement}\r\n\t\t\t\t\t\tname=\"filterFrom\"\r\n\t\t\t\t\t\tclassName=\"w-100\"\r\n\t\t\t\t\t\tlabel={t('publications.all.filterFrom')}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\tcomponent={DateElement}\r\n\t\t\t\t\t\tname=\"filterTo\"\r\n\t\t\t\t\t\tclassName=\"w-100\"\r\n\t\t\t\t\t\tlabel={t('publications.all.filterTo')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Row>\r\n\t\t\t)}\r\n\t\t</Translation>\r\n\r\n\t\t<Translation>\r\n\t\t\t{t => (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Button variant=\"info\" type=\"submit\">\r\n\t\t\t\t\t\t{t('common.search')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Translation>\r\n\t</form>\r\n);\r\n\r\nexport default reduxForm<IPublicationsFilterData>({\r\n\tform: 'publicationsFilterForm'\r\n})(PublicationsFilterForm);\r\n","import React from 'react';\r\nimport {Link} from 'react-router-dom';\r\nimport {Spinner} from 'react-bootstrap';\r\n\r\nimport {IPublication} from '../../../interfaces/models/IPublication';\r\nimport {Roles} from '../../../utils/helpers/RoleCodeToName';\r\nimport UserCan from '../../../common/UserCan';\r\n\r\n\r\ntype IPublicationItemProps = {\r\n\tpublication: IPublication,\r\n\tisDeleting: boolean,\r\n\tdel: (id: number) => void\r\n};\r\n\r\nconst PublicationItem: React.FC<IPublicationItemProps> = ({publication, isDeleting, del}) => (\r\n\t<tr>\r\n\t\t<th>{publication.id}</th>\r\n\t\t<th>{publication.title}</th>\r\n\t\t<th>{publication.authors}</th>\r\n\t\t<th>{publication.date_of_publication}</th>\r\n\t\t<th>\r\n\t\t\t<UserCan role={Roles.MODERATOR}>\r\n\t\t\t\t<Link to={`/publications/${publication.id}`}>\r\n\t\t\t\t\t<i className=\"fa fa-eye\"/>\r\n\t\t\t\t</Link>\r\n\r\n\t\t\t\t<Link to={`/publications/${publication.id}/edit`}>\r\n\t\t\t\t\t<i className=\"fa fa-pencil\"/>\r\n\t\t\t\t</Link>\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\tisDeleting ?\r\n\t\t\t\t\t\t<Link to=\"#\">\r\n\t\t\t\t\t\t\t<i className=\"fa fa-close\" onClick={() => del(publication.id)}/>\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<Spinner animation=\"border\" size=\"sm\"/>\r\n\t\t\t\t}\r\n\t\t\t</UserCan>\r\n\t\t</th>\r\n\t</tr>\r\n);\r\n\r\nexport default PublicationItem;\r\n","import {RootState} from '../../';\r\n\r\n\r\nexport const selectAllPublicationsState = (state: RootState) => state.publications.all;\r\nexport const selectAllPublications = (state: RootState) => selectAllPublicationsState(state).publications;\r\nexport const selectAllPublicationsSort = (state: RootState) => selectAllPublicationsState(state).sort;\r\n\r\nexport const selectAllPublicationsPagination = (state: RootState) => ({\r\n\tpageSize: selectAllPublicationsState(state).pageSize,\r\n\tcurPage: selectAllPublicationsState(state).currentPage,\r\n\ttotalItems: selectAllPublicationsState(state).total\r\n});\r\n","import {RootState} from '../../';\r\n\r\n\r\nexport const selectDeletePublications = (state: RootState) => state.publications.del;\r\n","import {\r\n\tALL_PUBLICATIONS_CHANGE_SORT,\r\n\tALL_PUBLICATIONS_ERROR,\r\n\tALL_PUBLICATIONS_START,\r\n\tALL_PUBLICATIONS_SUCCESS,\r\n\tALL_PUBLICATIONS_DELETE\r\n} from './types';\r\n\r\nimport {IGeneralPaginationResponse} from '../../../interfaces/responses/IGeneralPaginationResponse';\r\nimport {IPublication} from '../../../interfaces/models/IPublication';\r\n\r\n\r\ntype IResponse = IGeneralPaginationResponse<IPublication>;\r\n\r\nexport const allPublicationsStart = () => <const>({\r\n\ttype: ALL_PUBLICATIONS_START\r\n});\r\n\r\nexport const allPublicationsError = (error: string) => <const>({\r\n\ttype: ALL_PUBLICATIONS_ERROR,\r\n\terror\r\n});\r\n\r\nexport const allPublicationsSuccess = (ranksResponse: IResponse) => <const>({\r\n\ttype: ALL_PUBLICATIONS_SUCCESS,\r\n\tpayload: ranksResponse\r\n});\r\n\r\nexport const allPublicationsChangeSort = (field: string) => <const>({\r\n\ttype: ALL_PUBLICATIONS_CHANGE_SORT,\r\n\tpayload: field\r\n});\r\n\r\nexport const allPublicationsDelete = (id: number) => <const>({\r\n\ttype: ALL_PUBLICATIONS_DELETE,\r\n\tpayload: id\r\n});\r\n","import axios from 'axios';\r\n\r\nimport {ISort} from '../../../interfaces/ISort';\r\nimport {IGeneralPaginationResponse} from '../../../interfaces/responses/IGeneralPaginationResponse';\r\nimport {IPublication} from '../../../interfaces/models/IPublication';\r\n\r\nimport objToParams from '../../helpers/objToParams';\r\nimport {IPublicationsAddData} from '../../../pages/Publications/add/AddPublicationForm';\r\nimport {IPublicationsImportData} from '../../../pages/Publications/import/ImportPublicationsForm';\r\n\r\n\r\nconst client = axios.create({\r\n\tbaseURL: `${process.env.REACT_APP_SERVER_URL}/publications`,\r\n\theaders: {\r\n\t\t'Access-Control-Allow-Origin': '*',\r\n\t\tAuthorization: `Bearer ${localStorage.getItem('token')}`\r\n\t}\r\n});\r\n\r\nconst publicationsApi = {\r\n\tasync getPublications(filters: any = {}, sort: ISort[] = [], page = 1, pageSize = 5) {\r\n\t\tconst sortRules = objToParams(sort, 'sort');\r\n\r\n\t\treturn await client.get<IGeneralPaginationResponse<IPublication>>('/', {\r\n\t\t\tparams: {...filters, ...sortRules, page, pageSize}\r\n\t\t});\r\n\t},\r\n\r\n\tasync getPublication(id: number) {\r\n\t\treturn await client.get<{data: IPublication}>(`/${id}`);\r\n\t},\r\n\r\n\tasync editPublication(id: number, vals: any) {\r\n\t\treturn await client.put<IPublication>(`/${id}`, vals);\r\n\t},\r\n\r\n\tasync deletePublication(id: number) {\r\n\t\treturn await client.delete<{ message: string }>(`/${id}`);\r\n\t},\r\n\r\n\tasync addPublication(vals: IPublicationsAddData) {\r\n\t\treturn await client.post('/add', vals);\r\n\t},\r\n\r\n\tasync importPublications(vals: IPublicationsImportData | FormData){\r\n\t\tlet formData = new FormData();\r\n\r\n\t\tfor(let key in vals){\r\n\t\t\tformData.append(key, (vals as any)[key]);\r\n\t\t}\r\n\r\n\t\treturn await client.post('/import', formData);\r\n\t}\r\n};\r\n\r\nexport default publicationsApi;\r\n","import {ThunkAction, ThunkDispatch} from 'redux-thunk';\r\nimport {getFormValues} from 'redux-form';\r\n\r\nimport {RootState} from '../../';\r\nimport {IAllPublicationsActions} from './reducer';\r\n\r\nimport {\r\n\tallPublicationsError,\r\n\tallPublicationsStart,\r\n\tallPublicationsSuccess\r\n} from './actions';\r\nimport {selectAllPublicationsPagination, selectAllPublicationsSort} from './selectors';\r\nimport publicationsApi from '../../../utils/api/models/publicationsApi';\r\n\r\n\r\nexport type IAllPublicationsThunkAction = ThunkAction<void, RootState, unknown, IAllPublicationsActions>;\r\n\r\nconst thunkAllPublications = (page: number = 1): IAllPublicationsThunkAction => {\r\n\treturn async (dispatch: ThunkDispatch<{}, {}, IAllPublicationsActions>, getState) => {\r\n\t\tdispatch(allPublicationsStart());\r\n\r\n\t\ttry{\r\n\t\t\tconst form = getFormValues('publicationsFilterForm'),\r\n\t\t\t\tsort = selectAllPublicationsSort(getState()),\r\n\t\t\t\tpagination = selectAllPublicationsPagination(getState());\r\n\r\n\t\t\tconst resp = await publicationsApi.getPublications(form(getState()), sort, page, pagination.pageSize);\r\n\t\t\tdispatch(allPublicationsSuccess(resp.data));\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tdispatch(allPublicationsError(e.message));\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default thunkAllPublications;\r\n","import {\r\n\tDELETE_PUBLICATION_ERROR,\r\n\tDELETE_PUBLICATION_START,\r\n\tDELETE_PUBLICATION_SUCCESS\r\n} from './types';\r\n\r\n\r\nexport const deletePublicationStart = (id: number) => <const>({\r\n\ttype: DELETE_PUBLICATION_START,\r\n\tpayload: id\r\n});\r\n\r\nexport const deletePublicationError = (id: number, error: string) => <const>({\r\n\ttype: DELETE_PUBLICATION_ERROR,\r\n\terror,\r\n\tpayload: id\r\n});\r\n\r\nexport const deletePublicationSuccess = (id: number) => <const>({\r\n\ttype: DELETE_PUBLICATION_SUCCESS,\r\n\tpayload: id\r\n});\r\n","import {ThunkAction, ThunkDispatch} from 'redux-thunk';\r\nimport {toast} from 'react-toastify';\r\n\r\nimport {RootState} from '../../index';\r\nimport {IDeletePublicationActions} from './reducer';\r\n\r\nimport {deletePublicationError, deletePublicationStart, deletePublicationSuccess} from './actions';\r\nimport {allPublicationsDelete} from '../all/actions';\r\nimport publicationsApi from '../../../utils/api/models/publicationsApi';\r\n\r\n\r\ntype IActions = IDeletePublicationActions | ReturnType<typeof allPublicationsDelete>;\r\nexport type IPublicationEditThunkAction = ThunkAction<void, RootState, unknown, IActions>;\r\n\r\nconst thunkDeletePublication = (id: number): IPublicationEditThunkAction => {\r\n\treturn async (dispatch: ThunkDispatch<{}, {}, IActions>) => {\r\n\t\tdispatch(deletePublicationStart(id));\r\n\r\n\t\ttry{\r\n\t\t\tawait publicationsApi.deletePublication(id);\r\n\r\n\t\t\tdispatch(deletePublicationSuccess(id));\r\n\t\t\tdispatch(allPublicationsDelete(id));\r\n\t\t\ttoast.success(`Публикации с id ${id} удалено`);\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tdispatch(deletePublicationError(id, e.response?.data.message || e.message));\r\n\t\t\ttoast.error(`Ошибка: ${e.response?.data.message || e.message}`);\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default thunkDeletePublication;\r\n","import React, {useEffect} from 'react';\r\nimport {Table} from 'react-bootstrap';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\nimport {useTranslation} from 'react-i18next';\r\n\r\nimport {RootState} from '../../../redux';\r\nimport {IPublication} from '../../../interfaces/models/IPublication';\r\n\r\nimport SortItem from '../../../common/SortItem';\r\nimport Loader from '../../../common/Loader/Loader';\r\nimport ErrorElement from '../../../common/ErrorElement';\r\nimport findSortRule from '../../../utils/helpers/findSortRule';\r\nimport PublicationItem from './PublicationItem';\r\nimport {selectAllPublicationsState} from '../../../redux/publications/all/selectors';\r\nimport {selectDeletePublications} from '../../../redux/publications/delete/selectors';\r\nimport {allPublicationsChangeSort} from '../../../redux/publications/all/actions';\r\nimport thunkAllPublications from '../../../redux/publications/all/thunks';\r\nimport thunkDeletePublication from '../../../redux/publications/delete/thunks';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\t...selectAllPublicationsState(state),\r\n\tdeleting: selectDeletePublications(state)\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch: any) => ({\r\n\tchangeSort(field: string) {\r\n\t\tdispatch(allPublicationsChangeSort(field));\r\n\t\tdispatch(thunkAllPublications(1));\r\n\t},\r\n\tload(page = 1) {\r\n\t\tdispatch(thunkAllPublications(page));\r\n\t},\r\n\tdeleteItem(id: number) {\r\n\t\tdispatch(thunkDeletePublication(id));\r\n\t}\r\n});\r\n\r\nconst connected = connect(mapStateToProps, mapDispatchToProps);\r\n\r\ntype ICommissionsTableProps = ConnectedProps<typeof connected>;\r\nconst PublicationsTable: React.FC<ICommissionsTableProps> = (props) => {\r\n\tuseEffect(() => {\r\n\t\tif (!props.isLoading && !props.publications.length)\r\n\t\t\tprops.load();\r\n\t}, []);\r\n\r\n\tconst {t} = useTranslation();\r\n\r\n\treturn (\r\n\t\t<div className=\"table-wrapper\">\r\n\t\t\t<Table striped bordered hover style={{minWidth: \"600px\"}}>\r\n\t\t\t\t<thead>\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th>\r\n\t\t\t\t\t\t<span className=\"pull-left\">ID</span>\r\n\r\n\t\t\t\t\t\t<SortItem\r\n\t\t\t\t\t\t\tstate={findSortRule(props.sort, 'ID')?.direction}\r\n\t\t\t\t\t\t\tchange={props.changeSort}\r\n\t\t\t\t\t\t\tparam=\"ID\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</th>\r\n\r\n\t\t\t\t\t<th>\r\n\t\t\t\t\t<span className=\"pull-left\">\r\n\t\t\t\t\t\t{t('publications.all.name')}\r\n\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t<SortItem\r\n\t\t\t\t\t\t\tstate={findSortRule(props.sort, 'name')?.direction}\r\n\t\t\t\t\t\t\tchange={props.changeSort}\r\n\t\t\t\t\t\t\tparam=\"name\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</th>\r\n\r\n\t\t\t\t\t<th>\r\n\t\t\t\t\t<span className=\"pull-left\">\r\n\t\t\t\t\t\t{t('publications.all.authors')}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t</th>\r\n\r\n\t\t\t\t\t<th>\r\n\t\t\t\t\t<span className=\"pull-left\">\r\n\t\t\t\t\t\t{t('publications.all.date')}\r\n\t\t\t\t\t</span>\r\n\r\n\t\t\t\t\t\t<SortItem\r\n\t\t\t\t\t\t\tstate={findSortRule(props.sort, 'date')?.direction}\r\n\t\t\t\t\t\t\tchange={props.changeSort}\r\n\t\t\t\t\t\t\tparam=\"date\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</th>\r\n\r\n\t\t\t\t\t<th>{t('common.actions')}</th>\r\n\t\t\t\t</tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t{\r\n\t\t\t\t\tprops.isLoading &&\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<th colSpan={5} className=\"text-center\">\r\n\t\t\t\t\t\t\t<Loader/>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t}\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\tprops.error &&\r\n\t\t\t\t\t<tr className=\"text-center text-danger\">\r\n\t\t\t\t\t\t<th colSpan={5} className=\"text-center\">\r\n\t\t\t\t\t\t\t<ErrorElement error={props.error}/>\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t}\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\t!props.isLoading && !props.error && !props.publications.length &&\r\n\t\t\t\t\t<tr className=\"font-weight-bold text-center\">\r\n\t\t\t\t\t\t<th colSpan={5} className=\"text-center\">\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tt('common.noItems', {\r\n\t\t\t\t\t\t\t\t\twhat: t('publications.all.noForm')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</th>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t}\r\n\r\n\t\t\t\t{\r\n\t\t\t\t\t!props.isLoading && !props.error &&\r\n\t\t\t\t\tprops.publications.map((publication: IPublication) => (\r\n\t\t\t\t\t\t<PublicationItem\r\n\t\t\t\t\t\t\tkey={publication.id}\r\n\t\t\t\t\t\t\tpublication={publication}\r\n\t\t\t\t\t\t\tisDeleting={props.deleting.findIndex((id: number) => id == publication.id) == -1}\r\n\t\t\t\t\t\t\tdel={props.deleteItem}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))\r\n\t\t\t\t}\r\n\t\t\t\t</tbody>\r\n\t\t\t</Table>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default connected(PublicationsTable);\r\n","import React, {useEffect} from 'react';\r\nimport {Button, Card, Row} from 'react-bootstrap';\r\nimport {Link} from 'react-router-dom';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\nimport {useTranslation} from 'react-i18next';\r\n\r\nimport {RootState} from '../../../redux';\r\n\r\nimport BackButton from '../../../common/BackButton';\r\nimport PublicationsFilterForm from './PublicationsFilterForm';\r\nimport PublicationsTable from './PublicationsTable';\r\nimport Paginator from '../../../common/Paginator';\r\nimport UserCan from '../../../common/UserCan';\r\nimport {Roles} from '../../../utils/helpers/RoleCodeToName';\r\nimport {selectAllPublicationsPagination} from '../../../redux/publications/all/selectors';\r\nimport thunkAllPublications from '../../../redux/publications/all/thunks';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\tpaginator: selectAllPublicationsPagination(state)\r\n});\r\n\r\nconst connected = connect(mapStateToProps, {changePage: thunkAllPublications});\r\n\r\ntype IAllPublicationsPageProps = ConnectedProps<typeof connected>;\r\nconst AllPublicationsPage: React.FC<IAllPublicationsPageProps> = ({changePage, paginator}) => {\r\n\tconst {t} = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\tdocument.title = t('publications.all.pageTitle');\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"title\">\r\n\t\t\t\t{t('publications.name')}\r\n\t\t\t</div>\r\n\r\n\t\t\t<Card className=\"mr-5\">\r\n\t\t\t\t<Card.Body>\r\n\t\t\t\t\t<div className=\"model__filter-form\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<UserCan role={Roles.MODERATOR}>\r\n\t\t\t\t\t\t\t\t<Link to=\"/publications/add\">\r\n\t\t\t\t\t\t\t\t\t<Button variant=\"success\">\r\n\t\t\t\t\t\t\t\t\t\t{t('common.add')}\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t</UserCan>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<UserCan role={Roles.MODERATOR}>\r\n\t\t\t\t\t\t\t\t<Link to=\"/publications/import\">\r\n\t\t\t\t\t\t\t\t\t<Button variant=\"primary\">\r\n\t\t\t\t\t\t\t\t\t\t{t('common.import')}\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t</UserCan>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<PublicationsFilterForm onSubmit={() => changePage(1)}/>\r\n\r\n\t\t\t\t\t<div className=\"d-flex justify-content-center w-100\">\r\n\t\t\t\t\t\t<PublicationsTable/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"d-flex my-3 justify-content-end w-100\">\r\n\t\t\t\t\t\t<Paginator {...paginator} setCur={changePage}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Card.Body>\r\n\r\n\t\t\t\t<Card.Footer>\r\n\t\t\t\t\t<Row className=\"justify-content-between p-2\">\r\n\t\t\t\t\t\t<BackButton/>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Card.Footer>\r\n\t\t\t</Card>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default connected(AllPublicationsPage);\r\n","import {RootState} from '../../index';\r\n\r\n\r\nexport const selectEditPublicationState = (state: RootState) => state.publications.edit;\r\nexport const selectEditPublication = (state: RootState) => selectEditPublicationState(state).publication;\r\n","import {ThunkAction, ThunkDispatch} from 'redux-thunk';\r\n\r\nimport {IEditPublicationActions} from '../reducer';\r\nimport {RootState} from '../../../';\r\n\r\nimport {editPublicationLoadStart, editPublicationLoadError, editPublicationLoadSuccess} from '../actions';\r\nimport publicationsApi from '../../../../utils/api/models/publicationsApi';\r\n\r\n\r\nexport type IEditPublicationLoadThunkAction = ThunkAction<void, RootState, unknown, IEditPublicationActions>;\r\n\r\nconst thunkEditPublicationLoad = (id: number): IEditPublicationLoadThunkAction => {\r\n\treturn async (dispatch: ThunkDispatch<{}, {}, IEditPublicationActions>) => {\r\n\t\tdispatch(editPublicationLoadStart());\r\n\r\n\t\ttry{\r\n\t\t\tconst resp = await publicationsApi.getPublication(id);\r\n\t\t\tdispatch(editPublicationLoadSuccess(resp.data.data));\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tdispatch(editPublicationLoadError(e.response?.data.message || e.message));\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default thunkEditPublicationLoad;\r\n","import {\r\n\tEDIT_PUBLICATION_LOAD_ERROR,\r\n\tEDIT_PUBLICATION_LOAD_START,\r\n\tEDIT_PUBLICATION_LOAD_SUCCESS\r\n} from './types';\r\n\r\nimport {IPublication} from '../../../interfaces/models/IPublication';\r\n\r\n\r\nexport const editPublicationLoadStart = () => <const>({\r\n\ttype: EDIT_PUBLICATION_LOAD_START\r\n});\r\n\r\nexport const editPublicationLoadError = (error: string) => <const>({\r\n\ttype: EDIT_PUBLICATION_LOAD_ERROR,\r\n\terror\r\n});\r\n\r\nexport const editPublicationLoadSuccess = (publication: IPublication) => <const>({\r\n\ttype: EDIT_PUBLICATION_LOAD_SUCCESS,\r\n\tpayload: publication\r\n});\r\n","import {ThunkAction, ThunkDispatch} from 'redux-thunk';\r\nimport {Action} from 'redux';\r\nimport {startSubmit, stopSubmit} from 'redux-form';\r\nimport {toast} from 'react-toastify';\r\n\r\nimport {RootState} from '../../../index';\r\nimport publicationsApi from '../../../../utils/api/models/publicationsApi';\r\n\r\n\r\nexport type IPublicationEditThunkAction = ThunkAction<void, RootState, unknown, Action<any>>;\r\n\r\nconst thunkEditPublication = (id: number, vals: any): IPublicationEditThunkAction => {\r\n\treturn async (dispatch: ThunkDispatch<{}, {}, Action<any>>) => {\r\n\t\tdispatch(startSubmit('publicationsEditForm'));\r\n\r\n\t\ttry{\r\n\t\t\tawait publicationsApi.editPublication(id, vals);\r\n\r\n\t\t\tdispatch(stopSubmit('publicationsEditForm'));\r\n\t\t\ttoast.success('Публикация отредактирована');\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tdispatch(stopSubmit('publicationsEditForm', {\r\n\t\t\t\t_error: e.response?.data.message || e.message,\r\n\t\t\t\t...e.response?.data.errors\r\n\t\t\t}));\r\n\r\n\t\t\ttoast.error(e.response?.data.message || e.message);\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default thunkEditPublication;\r\n","import React, {useEffect} from 'react';\r\nimport {reduxForm, InjectedFormProps, Field} from 'redux-form';\r\nimport {Translation} from 'react-i18next';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\n\r\nimport InputElement from '../../../common/formElements/InputElement';\r\nimport required from '../../../utils/validators/required';\r\nimport DateElement from '../../../common/formElements/DateElement';\r\nimport DataListElement from '../../../common/formElements/DataListElement';\r\nimport {RootState} from '../../../redux';\r\nimport {selectEditPublication} from '../../../redux/publications/edit/selectors';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\tpublication: selectEditPublication(state)\r\n});\r\n\r\nconst connected = connect(mapStateToProps);\r\n\r\nexport type IPublicationsEditData = {\r\n\ttitle: string,\r\n\turl: string,\r\n\tpublisher: string,\r\n\tdate: string,\r\n\tauthors: number[],\r\n\tanother_authors: string,\r\n\tdescription?: string\r\n};\r\n\r\ntype IOwnProps = ConnectedProps<typeof connected>;\r\n\r\ntype IPublicationsEditFormProps = InjectedFormProps<IPublicationsEditData, IOwnProps> & IOwnProps;\r\nconst PublicationsEditForm: React.FC<IPublicationsEditFormProps> = (props) => {\r\n\tconst {handleSubmit, error, initialize, publication} = props;\r\n\t\r\n\tuseEffect(() => {\r\n\t\tinitialize({...publication} as any);\r\n\t}, []);\r\n\t\r\n\treturn (\r\n\t\t<form onSubmit={handleSubmit}>\r\n\r\n\t\t\t{\r\n\t\t\t\terror &&\r\n\t\t\t\t<div>{error}</div>\r\n\t\t\t}\r\n\r\n\t\t\t<div className=\"d-md-flex w-100\">\r\n\t\t\t\t<Translation>\r\n\t\t\t\t\t{t => (\r\n\t\t\t\t\t\t<div className=\"w-100 pr-3\">\r\n\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tname=\"title\"\r\n\t\t\t\t\t\t\t\tlabel={t('publications.edit.name')}\r\n\t\t\t\t\t\t\t\tvalidate={[required]}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tname=\"publisher\"\r\n\t\t\t\t\t\t\t\tlabel={t('publications.edit.publisher')}\r\n\t\t\t\t\t\t\t\tvalidate={[required]}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tname=\"url\"\r\n\t\t\t\t\t\t\t\tlabel={t('publications.edit.url')}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Translation>\r\n\r\n\t\t\t\t<Translation>\r\n\t\t\t\t\t{t => (\r\n\t\t\t\t\t\t<div className=\"w-100 pl-3\">\r\n\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\tcomponent={DateElement}\r\n\t\t\t\t\t\t\t\tname=\"date\"\r\n\t\t\t\t\t\t\t\tclassName=\"mb-2\"\r\n\t\t\t\t\t\t\t\tlabel={t('publications.edit.date')}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\tcomponent={DataListElement}\r\n\t\t\t\t\t\t\t\tname=\"authors\"\r\n\t\t\t\t\t\t\t\tplaceholder={t('publications.edit.authors')}\r\n\t\t\t\t\t\t\t\turl={`${process.env.REACT_APP_SERVER_URL}/search/users`}\r\n\t\t\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tname=\"another_authors\"\r\n\t\t\t\t\t\t\t\tlabel={t('publications.edit.anotherAuthors')}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Translation>\r\n\t\t\t</div>\r\n\r\n\t\t\t<Translation>\r\n\t\t\t\t{t => (\r\n\t\t\t\t\t<div className=\"w-100 mt-2\">\r\n\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\tcomponent=\"textarea\"\r\n\t\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\t\tname=\"description\"\r\n\t\t\t\t\t\t\trows={5}\r\n\t\t\t\t\t\t\tlabel={t('publications.edit.description')}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Translation>\r\n\t\t</form>\r\n\t);\r\n};\r\n\r\nexport default connected(\r\n\t\treduxForm<IPublicationsEditData, IOwnProps>({\r\n\t\t\tform: 'publicationsEditForm'\r\n\t\t})(PublicationsEditForm)\r\n);\r\n","import React, {useEffect} from 'react';\r\nimport {Button, Card, Row, Spinner} from 'react-bootstrap';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\nimport {RouteComponentProps} from 'react-router-dom';\r\nimport {isSubmitting, submit} from 'redux-form';\r\nimport {useTranslation} from 'react-i18next';\r\n\r\nimport {RootState} from '../../../redux';\r\nimport BackButton from '../../../common/BackButton';\r\nimport ErrorElement from '../../../common/ErrorElement';\r\nimport Loader from '../../../common/Loader/Loader';\r\nimport IsUserRoleMore from '../../../utils/HOC/IsUserRoleMore';\r\nimport {Roles} from '../../../utils/helpers/RoleCodeToName';\r\nimport {selectEditPublicationState} from '../../../redux/publications/edit/selectors';\r\nimport thunkEditPublicationLoad from '../../../redux/publications/edit/thunks/thunkEditPublicationLoad';\r\nimport thunkEditPublication from '../../../redux/publications/edit/thunks/thunkEditPublication';\r\nimport EditPublicationForm, {IPublicationsEditData} from './EditPublicationForm';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\teditState: selectEditPublicationState(state),\r\n\tsubmitting: isSubmitting('publicationsEditForm')(state)\r\n});\r\n\r\nconst connected = connect(mapStateToProps, {\r\n\tloadPublication: thunkEditPublicationLoad,\r\n\tsend: submit,\r\n\teditPublication: thunkEditPublication\r\n});\r\n\r\ntype IEditPublicationPageProps = ConnectedProps<typeof connected> & RouteComponentProps<{id?: string}>;\r\nconst EditPublicationPage: React.FC<IEditPublicationPageProps> = ({editState, loadPublication, ...props}) => {\r\n\tconst {t} = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\tloadPublication(+props.match.params.id);\r\n\t\tdocument.title = t('publications.edit.pageTitle');\r\n\t}, []);\r\n\r\n\tconst clickHandler = () => {\r\n\t\tprops.send('publicationsEditForm');\r\n\t};\r\n\r\n\tconst submitHandler = (vals: IPublicationsEditData) => {\r\n\t\tprops.editPublication(+props.match.params.id, vals);\r\n\t};\r\n\r\n\tif(!editState.publication && !editState.isLoading)\r\n\t\treturn null;\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"title\">{t('publications.edit.pageTitle')}</div>\r\n\r\n\t\t\t<Card className=\"mr-5\">\r\n\t\t\t\t<Card.Body>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\teditState.isLoading &&\r\n\t\t\t\t\t\t\t<Loader/>\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t!editState.isLoading && editState.error &&\r\n\t\t\t\t\t\t\t<ErrorElement error={editState.error}/>\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t!editState.isLoading && !editState.error &&\r\n\t\t\t\t\t\t\t<EditPublicationForm onSubmit={submitHandler}/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Card.Body>\r\n\r\n\t\t\t\t<Card.Footer>\r\n\t\t\t\t\t<Row className=\"justify-content-between p-2\">\r\n\t\t\t\t\t\t<BackButton/>\r\n\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t!editState.isLoading && !editState.error &&\r\n\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\tvariant=\"warning\"\r\n\t\t\t\t\t\t\t\t\tonClick={clickHandler}\r\n\t\t\t\t\t\t\t\t\tdisabled={props.submitting}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tprops.submitting &&\r\n\t\t\t\t\t\t\t\t\t\t\t<Spinner animation=\"border\" size=\"sm\"/>\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t{t('common.edit')}\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Card.Footer>\r\n\t\t\t</Card>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default IsUserRoleMore(Roles.MODERATOR, true)(connected(EditPublicationPage));\r\n","import React from 'react';\r\nimport {reduxForm, InjectedFormProps, Field} from 'redux-form';\r\nimport {Translation} from 'react-i18next';\r\n\r\nimport InputElement from '../../../common/formElements/InputElement';\r\nimport required from '../../../utils/validators/required';\r\nimport DateElement from '../../../common/formElements/DateElement';\r\nimport DataListElement from '../../../common/formElements/DataListElement';\r\n\r\n\r\nexport type IPublicationsAddData = {\r\n\ttitle: string,\r\n\turl: string,\r\n\tpublisher: string,\r\n\tdate: string,\r\n\tauthors: number[],\r\n\tanother_authors: string,\r\n\tdescription?: string\r\n};\r\n\r\ntype IPublicationsAddFormProps = InjectedFormProps<IPublicationsAddData>;\r\nconst PublicationsAddForm: React.FC<IPublicationsAddFormProps> = ({handleSubmit, error}) => (\r\n\t<form onSubmit={handleSubmit}>\r\n\r\n\t\t{\r\n\t\t\terror &&\r\n\t\t\t\t<div>{error}</div>\r\n\t\t}\r\n\t\t\r\n\t\t<div className=\"d-md-flex w-100\">\r\n\t\t\t<Translation>\r\n\t\t\t\t{t => (\r\n\t\t\t\t\t<div className=\"w-100 pr-3\">\r\n\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tname=\"title\"\r\n\t\t\t\t\t\t\tlabel={t('publications.add.name')}\r\n\t\t\t\t\t\t\tvalidate={[required]}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tname=\"publisher\"\r\n\t\t\t\t\t\t\tlabel={t('publications.add.publisher')}\r\n\t\t\t\t\t\t\tvalidate={[required]}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tname=\"url\"\r\n\t\t\t\t\t\t\tlabel={t('publications.add.url')}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Translation>\r\n\r\n\t\t\t<Translation>\r\n\t\t\t\t{t => (\r\n\t\t\t\t\t<div className=\"w-100 pl-3\">\r\n\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\tcomponent={DateElement}\r\n\t\t\t\t\t\t\tname=\"date\"\r\n\t\t\t\t\t\t\tclassName=\"mb-2\"\r\n\t\t\t\t\t\t\tlabel={t('publications.add.date')}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\tcomponent={DataListElement}\r\n\t\t\t\t\t\t\tname=\"authors\"\r\n\t\t\t\t\t\t\tplaceholder={t('publications.add.authors')}\r\n\t\t\t\t\t\t\turl={`${process.env.REACT_APP_SERVER_URL}/search/users`}\r\n\t\t\t\t\t\t\tmultiple\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t<Field\r\n\t\t\t\t\t\t\tcomponent={InputElement}\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tname=\"another_authors\"\r\n\t\t\t\t\t\t\tlabel={t('publications.add.anotherAuthors')}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</Translation>\r\n\t\t</div>\r\n\r\n\t\t<Translation>\r\n\t\t\t{t => (\r\n\t\t\t\t<div className=\"w-100 mt-2\">\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\tcomponent=\"textarea\"\r\n\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\tname=\"description\"\r\n\t\t\t\t\t\trows={5}\r\n\t\t\t\t\t\tlabel={t('publications.add.description')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Translation>\r\n\t</form>\r\n);\r\n\r\nexport default reduxForm<IPublicationsAddData>({\r\n\tform: 'publicationsAddForm'\r\n})(PublicationsAddForm);\r\n","import {ThunkAction, ThunkDispatch} from 'redux-thunk';\r\nimport {Action} from 'redux';\r\nimport {reset, startSubmit, stopSubmit} from 'redux-form';\r\nimport {toast} from 'react-toastify';\r\n\r\nimport {RootState} from '../../index';\r\nimport publicationsApi from '../../../utils/api/models/publicationsApi';\r\n\r\n\r\nexport type IAddPublicationThunkAction = ThunkAction<void, RootState, unknown, Action<any>>;\r\n\r\nconst thunkAddPublication = (vals: any): IAddPublicationThunkAction => {\r\n\treturn async (dispatch: ThunkDispatch<{}, {}, Action<any>>) => {\r\n\t\tdispatch(startSubmit('publicationsAddForm'));\r\n\r\n\t\ttry{\r\n\t\t\tawait publicationsApi.addPublication(vals);\r\n\t\t\tdispatch(stopSubmit('publicationsAddForm'));\r\n\t\t\tdispatch(reset('publicationsAddForm'));\r\n\r\n\t\t\ttoast.success('Публикация добавлена');\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tdispatch(stopSubmit('publicationsAddForm', {\r\n\t\t\t\t_error: e.response?.data.message || e.message,\r\n\t\t\t\t...e.response?.data.errors\r\n\t\t\t}));\r\n\r\n\t\t\ttoast.error(e.response?.data.message || e.message);\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default thunkAddPublication;\r\n","import React, {useEffect} from 'react';\r\nimport {Button, Card, Row, Spinner} from 'react-bootstrap';\r\nimport {ConnectedProps, connect} from 'react-redux';\r\nimport {submit, isSubmitting} from 'redux-form';\r\nimport {useTranslation} from 'react-i18next';\r\n\r\nimport {RootState} from '../../../redux';\r\nimport BackButton from '../../../common/BackButton';\r\nimport AddPublicationForm from './AddPublicationForm';\r\nimport IsUserRoleMore from '../../../utils/HOC/IsUserRoleMore';\r\nimport {Roles} from '../../../utils/helpers/RoleCodeToName';\r\nimport thunkAddPublication from '../../../redux/publications/add/thunks';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\tsubmitting: isSubmitting('publicationsAddForm')(state)\r\n});\r\n\r\nconst connected = connect(mapStateToProps, {\r\n\tadd: thunkAddPublication,\r\n\tsend: submit\r\n});\r\n\r\ntype IAddPublicationPageProps = ConnectedProps<typeof connected>;\r\nconst AddPublicationPage: React.FC<IAddPublicationPageProps> = ({add, send, submitting}) => {\r\n\tconst {t} = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\tdocument.title = t('publications.add.pageTitle');\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"title\">\r\n\t\t\t\t{t('publications.add.pageTitle')}\r\n\t\t\t</div>\r\n\r\n\t\t\t<Card className=\"mr-5\">\r\n\t\t\t\t<Card.Body>\r\n\t\t\t\t\t<AddPublicationForm onSubmit={add}/>\r\n\t\t\t\t</Card.Body>\r\n\r\n\t\t\t\t<Card.Footer>\r\n\t\t\t\t\t<Row className=\"justify-content-between p-2\">\r\n\t\t\t\t\t\t<BackButton/>\r\n\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tvariant=\"success\"\r\n\t\t\t\t\t\t\tonClick={() => send('publicationsAddForm')}\r\n\t\t\t\t\t\t\tdisabled={submitting}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{submitting && <Spinner size=\"sm\" animation=\"border\"/>}\r\n\t\t\t\t\t\t\t{t('common.add')}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Card.Footer>\r\n\t\t\t</Card>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default IsUserRoleMore(Roles.MODERATOR, true)(connected(AddPublicationPage));\r\n","import {RootState} from '../../';\r\n\r\n\r\nexport const selectPublicationSingleState = (state: RootState) => state.publications.single;\r\nexport const selectPublicationSingle = (state: RootState) => selectPublicationSingleState(state).publication;\r\n","import React from 'react';\r\nimport {Trans, Translation} from 'react-i18next';\r\n\r\nimport {IPublication} from '../../../interfaces/models/IPublication';\r\n\r\n\r\ntype IPublicationInfoProps = {\r\n\tpublication: IPublication\r\n}\r\n\r\nconst PublicationInfo: React.FC<IPublicationInfoProps> = ({publication}) => (\r\n\t<Translation>\r\n\t\t{t => (\r\n\t\t\t<div>\r\n\t\t\t\t<Trans i18nKey=\"publications.single.id\">\r\n\t\t\t\t\t<div>ID: {{id: publication.id}}</div>\r\n\t\t\t\t</Trans>\r\n\r\n\t\t\t\t<Trans i18nKey=\"publications.single.title\">\r\n\t\t\t\t\t<div>Title: {{title: publication.title}}</div>\r\n\t\t\t\t</Trans>\r\n\r\n\t\t\t\t<Trans i18nKey=\"publications.single.date\">\r\n\t\t\t\t\t<div>Date of publication: {{id: publication.date_of_publication}}</div>\r\n\t\t\t\t</Trans>\r\n\r\n\t\t\t\t<Trans i18nKey=\"publications.single.authors\">\r\n\t\t\t\t\t<div>Authors: {{authors: publication.authors}}</div>\r\n\t\t\t\t</Trans>\r\n\r\n\t\t\t\t<Trans i18nKey=\"publications.single.publisher\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\tPublisher: {{\r\n\t\t\t\t\t\t\tpublisher: publication.publisher || t('common.notSetted')\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Trans>\r\n\r\n\t\t\t\t<Trans i18nKey=\"publications.single.url\">\r\n\t\t\t\t\t<div>URL: <a href={publication.url}>{{url: publication.url}}</a></div>\r\n\t\t\t\t</Trans>\r\n\r\n\t\t\t\t<Trans i18nKey=\"publications.single.description\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\tDescription: {{\r\n\t\t\t\t\t\t\tdescription: publication.description || t('common.notSetted')\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Trans>\r\n\t\t\t</div>\r\n\t\t)}\r\n\t</Translation>\r\n);\r\n\r\nexport default PublicationInfo;\r\n","import {ThunkAction, ThunkDispatch} from 'redux-thunk';\r\nimport {Action} from 'redux';\r\nimport {toast} from 'react-toastify';\r\n\r\nimport {RootState} from '../../';\r\nimport {publicationSingleError, publicationSingleStart, publicationSingleSuccess} from './actions';\r\nimport publicationsApi from '../../../utils/api/models/publicationsApi';\r\n\r\n\r\nexport type IPublicationSingleThunkAction = ThunkAction<void, RootState, unknown, Action<any>>;\r\n\r\nconst thunkSinglePublication = (id: number): IPublicationSingleThunkAction => {\r\n\treturn async (dispatch: ThunkDispatch<{}, {}, Action<any>>) => {\r\n\t\tdispatch(publicationSingleStart());\r\n\r\n\t\ttry{\r\n\t\t\tconst resp = await publicationsApi.getPublication(id);\r\n\t\t\tdispatch(publicationSingleSuccess(resp.data.data));\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tdispatch(publicationSingleError(e.response?.data.message || e.message));\r\n\t\t\ttoast.error(e.response?.data.message || e.message);\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default thunkSinglePublication;\r\n","import {\r\n\tPUBLICATION_SINGLE_ERROR,\r\n\tPUBLICATION_SINGLE_START,\r\n\tPUBLICATION_SINGLE_SUCCESS\r\n} from './types';\r\nimport {IPublication} from '../../../interfaces/models/IPublication';\r\n\r\n\r\nexport const publicationSingleStart = () => <const>({\r\n\ttype: PUBLICATION_SINGLE_START\r\n});\r\n\r\nexport const publicationSingleError = (error: string) => <const>({\r\n\ttype: PUBLICATION_SINGLE_ERROR,\r\n\terror\r\n});\r\n\r\nexport const publicationSingleSuccess = (publication: IPublication) => <const>({\r\n\ttype: PUBLICATION_SINGLE_SUCCESS,\r\n\tpayload: publication\r\n});\r\n","import React, {useEffect} from 'react';\r\nimport {RouteComponentProps} from 'react-router';\r\nimport {Button, Card, Row} from 'react-bootstrap';\r\nimport {useTranslation} from 'react-i18next';\r\nimport {Link} from 'react-router-dom';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\n\r\nimport BackButton from '../../../common/BackButton';\r\nimport {RootState} from '../../../redux';\r\nimport {selectPublicationSingleState} from '../../../redux/publications/single/selectors';\r\nimport Loader from '../../../common/Loader/Loader';\r\nimport PublicationInfo from './PublicationInfo';\r\nimport thunkSinglePublication from '../../../redux/publications/single/thunks';\r\nimport ErrorElement from '../../../common/ErrorElement';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\t...selectPublicationSingleState(state)\r\n});\r\n\r\nconst connected = connect(mapStateToProps, {load: thunkSinglePublication});\r\n\r\ntype ISinglePublicationPageProps = RouteComponentProps<{id: string}> & ConnectedProps<typeof connected>;\r\nconst SinglePublicationPage: React.FC<ISinglePublicationPageProps> = (props) => {\r\n\tconst {match, isLoading, error, publication, load} = props;\r\n\tconst {t} = useTranslation();\r\n\r\n\tuseEffect(() => {\r\n\t\tload(+match.params.id);\r\n\t}, []);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"title\">\r\n\t\t\t\t{t('publications.single.pageTitle')}\r\n\t\t\t</div>\r\n\r\n\t\t\t<Card className=\"mr-5\">\r\n\t\t\t\t<Card.Body>\r\n\t\t\t\t\t{isLoading && <Loader/>}\r\n\t\t\t\t\t{!isLoading && error && <ErrorElement error={error}/>}\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t!isLoading && !error && publication &&\r\n\t\t\t\t\t\t\t<PublicationInfo publication={publication}/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Card.Body>\r\n\r\n\t\t\t\t<Card.Footer>\r\n\t\t\t\t\t<Row className=\"justify-content-between p-2\">\r\n\t\t\t\t\t\t<BackButton/>\r\n\r\n\t\t\t\t\t\t<Link to={`/publications/${match.params.id}/edit`}>\r\n\t\t\t\t\t\t\t<Button variant=\"warning\">\r\n\t\t\t\t\t\t\t\t{t('common.edit')}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Card.Footer>\r\n\t\t\t</Card>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default connected(SinglePublicationPage);\r\n","import React from 'react';\r\nimport {reduxForm, InjectedFormProps, Field} from 'redux-form';\r\nimport {Translation} from 'react-i18next';\r\n\r\nimport FileElement from '../../../common/formElements/FileElement';\r\nimport required from '../../../utils/validators/required';\r\n\r\n\r\nexport type IPublicationsImportData = {\r\n\timportFile: File\r\n};\r\n\r\ntype IPublicationsImportFormProps = InjectedFormProps<IPublicationsImportData>;\r\nconst PublicationsImportForm: React.FC<IPublicationsImportFormProps> = ({handleSubmit, error}) => (\r\n\t<form onSubmit={handleSubmit} className=\"w-50\">\r\n\r\n\t\t{\r\n\t\t\terror &&\r\n\t\t\t<div>{error}</div>\r\n\t\t}\r\n\r\n\t\t<Translation>\r\n\t\t\t{t => (\r\n\t\t\t\t<div className=\"center w-100\">\r\n\t\t\t\t\t<Field\r\n\t\t\t\t\t\tname=\"importFile\"\r\n\t\t\t\t\t\tlabel={t('publications.import.file')}\r\n\t\t\t\t\t\tcomponent={FileElement}\r\n\t\t\t\t\t\tvalidate={[required]}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Translation>\r\n\t</form>\r\n);\r\n\r\nexport default reduxForm<IPublicationsImportData>({\r\n\tform: 'importPublicationsForm'\r\n})(PublicationsImportForm);\r\n","import {ThunkAction, ThunkDispatch} from 'redux-thunk';\r\nimport {Action} from 'redux';\r\nimport {reset, startSubmit, stopSubmit} from 'redux-form';\r\nimport {toast} from 'react-toastify';\r\n\r\nimport {RootState} from '../../';\r\nimport publicationsApi from '../../../utils/api/models/publicationsApi';\r\nimport {IPublicationsImportData} from '../../../pages/Publications/import/ImportPublicationsForm';\r\n\r\n\r\nexport type IImportPublicationThunkAction = ThunkAction<void, RootState, unknown, Action<any>>;\r\n\r\nconst thunkImportPublication = (vals: IPublicationsImportData): IImportPublicationThunkAction => {\r\n\treturn async (dispatch: ThunkDispatch<{}, {}, Action<any>>) => {\r\n\t\tdispatch(startSubmit('importPublicationsForm'));\r\n\r\n\t\ttry{\r\n\t\t\tawait publicationsApi.importPublications(vals);\r\n\t\t\tdispatch(stopSubmit('importPublicationsForm'));\r\n\t\t\tdispatch(reset('importPublicationsForm'));\r\n\r\n\t\t\ttoast.success('Публикации импортированы');\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tdispatch(stopSubmit('importPublicationsForm', {\r\n\t\t\t\t_error: e.response?.data.message || e.message,\r\n\t\t\t\t...e.response?.data.errors\r\n\t\t\t}));\r\n\r\n\t\t\ttoast.error(e.response?.data.message || e.message);\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default thunkImportPublication;\r\n","import React from 'react';\r\nimport {Button, Card, Row, Spinner} from 'react-bootstrap';\r\nimport {useTranslation} from 'react-i18next';\r\nimport {connect, ConnectedProps} from 'react-redux';\r\nimport {isSubmitting, submit} from 'redux-form';\r\n\r\nimport BackButton from '../../../common/BackButton';\r\nimport ImportPublicationsForm from './ImportPublicationsForm';\r\nimport {RootState} from '../../../redux';\r\nimport thunkImportPublication from '../../../redux/publications/import/thunks';\r\n\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n\tisSubmit: isSubmitting('importPublicationsForm')(state)\r\n});\r\n\r\nconst connected = connect(mapStateToProps, {\r\n\timportPublications: thunkImportPublication,\r\n\tsend: () => submit('importPublicationsForm')\r\n});\r\n\r\ntype IImportPublicationsPageProps = ConnectedProps<typeof connected>;\r\nconst ImportPublicationsPage: React.FC<IImportPublicationsPageProps> = (props) => {\r\n\tconst {isSubmit, importPublications, send} = props;\r\n\tconst {t} = useTranslation();\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"title\">\r\n\t\t\t\t{t('publications.import.pageTitle')}\r\n\t\t\t</div>\r\n\r\n\t\t\t<Card className=\"mr-5\">\r\n\t\t\t\t<Card.Body className=\"d-flex flex-column align-items-center\">\r\n\t\t\t\t\t<ImportPublicationsForm onSubmit={importPublications}/>\r\n\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\thref={`${process.env.REACT_APP_SERVER_URL}/examples/publications`}\r\n\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\tclassName=\"mt-3\"\r\n\t\t\t\t\t>{t('common.downloadExample')}</a>\r\n\t\t\t\t</Card.Body>\r\n\r\n\t\t\t\t<Card.Footer>\r\n\t\t\t\t\t<Row className=\"justify-content-between p-2\">\r\n\t\t\t\t\t\t<BackButton/>\r\n\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tvariant=\"success\"\r\n\t\t\t\t\t\t\tonClick={send}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{isSubmit && <Spinner animation=\"border\" size=\"sm\"/>}\r\n\r\n\t\t\t\t\t\t\t<span className=\"mr-1\">\r\n\t\t\t\t\t\t\t\t{t('common.import')}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Row>\r\n\t\t\t\t</Card.Footer>\r\n\t\t\t</Card>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default connected(ImportPublicationsPage);\r\n","import React from 'react';\r\nimport {Route, Switch} from 'react-router-dom';\r\n\r\nimport NotFoundPage from '../ErrorPages/NotFoundPage';\r\nimport AllPublicationsPage from './all';\r\nimport EditPublicationPage from './edit';\r\nimport AddPublicationPage from './add';\r\nimport SinglePublicationPage from './single';\r\nimport ImportPublicationPage from './import';\r\n\r\nimport IsUserRoleMore from '../../utils/HOC/IsUserRoleMore';\r\nimport {Roles} from '../../utils/helpers/RoleCodeToName';\r\n\r\n\r\nconst Publications: React.FC<{}> = () => (\r\n\t<Switch>\r\n\t\t<Route path=\"/publications\" exact component={AllPublicationsPage}/>\r\n\t\t<Route path=\"/publications/add\" exact component={AddPublicationPage}/>\r\n\t\t<Route path=\"/publications/import\" exact component={ImportPublicationPage}/>\r\n\t\t<Route path=\"/publications/:id/edit\" exact component={EditPublicationPage}/>\r\n\t\t<Route path=\"/publications/:id\" exact component={SinglePublicationPage}/>\r\n\t\t<Route path=\"/\" component={NotFoundPage}/>\r\n\t</Switch>\r\n);\r\n\r\nexport default IsUserRoleMore(Roles.VIEWER, true)(Publications);\r\n"],"sourceRoot":""}